<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ClassStatistics.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Student-Grade-Management</a> &gt; <a href="index.source.html" class="el_package">default</a> &gt; <span class="el_source">ClassStatistics.java</span></div><h1>ClassStatistics.java</h1><pre class="source lang-java linenums">import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

// This class calculates various statistical metrics for the class grades
<span class="fc" id="L9">public class ClassStatistics {</span>

    // This method generates a comprehensive statistical report for all class grades
    public String generateClassStatisticsReport(List&lt;Grade&gt; allGrades, List&lt;Student&gt; allStudents) {
<span class="pc bpc" id="L13" title="1 of 4 branches missed.">        if (allGrades == null || allGrades.isEmpty()) {</span>
<span class="fc" id="L14">            return &quot;No grades available for statistics.&quot;;</span>
        }

<span class="fc" id="L17">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L18">        sb.append(&quot;\nCLASS STATISTICS\n&quot;);</span>
<span class="fc" id="L19">        sb.append(&quot;__________________________________________________\n\n&quot;);</span>

<span class="fc" id="L21">        sb.append(&quot;Total Students: &quot; + allStudents.size() + &quot;\n&quot;);</span>
<span class="fc" id="L22">        sb.append(&quot;Total Grades Recorded: &quot; + allGrades.size() + &quot;\n\n&quot;);</span>

        // Grade Distribution
<span class="fc" id="L25">        sb.append(&quot;GRADE DISTRIBUTION\n&quot;);</span>
<span class="fc" id="L26">        sb.append(&quot;__________________________________________________\n&quot;);</span>
<span class="fc" id="L27">        appendGradeDistribution(sb, allGrades);</span>

        // Statistical Analysis
<span class="fc" id="L30">        List&lt;Double&gt; gradeValues = allGrades.stream().map(Grade::getGrade).sorted().collect(Collectors.toList());</span>
<span class="fc" id="L31">        sb.append(&quot;\nSTATISTICAL ANALYSIS\n&quot;);</span>
<span class="fc" id="L32">        sb.append(&quot;__________________________________________________\n&quot;);</span>
<span class="fc" id="L33">        sb.append(String.format(&quot;Mean (Average):      %.1f%%%n&quot;, calculateMean(gradeValues)));</span>
<span class="fc" id="L34">        sb.append(String.format(&quot;Median:              %.1f%%%n&quot;, calculateMedian(gradeValues)));</span>
<span class="fc" id="L35">        sb.append(String.format(&quot;Mode:                %.1f%%%n&quot;, calculateMode(gradeValues)));</span>
<span class="fc" id="L36">        sb.append(String.format(&quot;Standard Deviation:  %.1f%n&quot;, calculateStandardDeviation(gradeValues)));</span>
<span class="fc" id="L37">        sb.append(String.format(&quot;Range:               %.1f%% (%.0f%% - %.0f%%)%n&quot;,</span>
<span class="fc" id="L38">                gradeValues.get(gradeValues.size() - 1) - gradeValues.get(0),</span>
<span class="fc" id="L39">                gradeValues.get(0),</span>
<span class="fc" id="L40">                gradeValues.get(gradeValues.size() - 1)));</span>

        // High/Low
<span class="fc" id="L43">        Grade highest = allGrades.stream().max((g1, g2) -&gt; Double.compare(g1.getGrade(), g2.getGrade())).orElse(null);</span>
<span class="fc" id="L44">        Grade lowest = allGrades.stream().min((g1, g2) -&gt; Double.compare(g1.getGrade(), g2.getGrade())).orElse(null);</span>

<span class="fc" id="L46">        Map&lt;String, String&gt; studentNames = allStudents.stream()</span>
<span class="fc" id="L47">                .collect(Collectors.toMap(Student::getStudentId, Student::getName));</span>

<span class="pc bpc" id="L49" title="1 of 2 branches missed.">        if (highest != null) {</span>
<span class="fc" id="L50">            sb.append(String.format(&quot;\nHighest Grade:       %.0f%% (%s - %s)%n&quot;,</span>
<span class="fc" id="L51">                    highest.getGrade(), highest.getStudentID(), highest.getSubject().getSubjectName()));</span>
        }
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">        if (lowest != null) {</span>
<span class="fc" id="L54">            sb.append(String.format(&quot;Lowest Grade:        %.0f%% (%s - %s)%n&quot;,</span>
<span class="fc" id="L55">                    lowest.getGrade(), lowest.getStudentID(), lowest.getSubject().getSubjectName()));</span>
        }

        // Subject Performance
<span class="fc" id="L59">        sb.append(&quot;\nSUBJECT PERFORMANCE\n&quot;);</span>
<span class="fc" id="L60">        sb.append(&quot;__________________________________________________\n&quot;);</span>
<span class="fc" id="L61">        appendSubjectPerformance(sb, allGrades);</span>

        // Student Type Comparison
<span class="fc" id="L64">        sb.append(&quot;\nSTUDENT TYPE COMPARISON\n&quot;);</span>
<span class="fc" id="L65">        sb.append(&quot;__________________________________________________\n&quot;);</span>
<span class="fc" id="L66">        appendStudentTypeComparison(sb, allGrades, allStudents);</span>

<span class="fc" id="L68">        return sb.toString();</span>
    }

    private void appendGradeDistribution(StringBuilder sb, List&lt;Grade&gt; grades) {
<span class="fc" id="L72">        int[] counts = new int[5]; // A, B, C, D, F</span>
<span class="fc bfc" id="L73" title="All 2 branches covered.">        for (Grade g : grades) {</span>
<span class="fc" id="L74">            double val = g.getGrade();</span>
<span class="fc bfc" id="L75" title="All 2 branches covered.">            if (val &gt;= 90)</span>
<span class="fc" id="L76">                counts[0]++;</span>
<span class="fc bfc" id="L77" title="All 2 branches covered.">            else if (val &gt;= 80)</span>
<span class="fc" id="L78">                counts[1]++;</span>
<span class="pc bpc" id="L79" title="1 of 2 branches missed.">            else if (val &gt;= 70)</span>
<span class="fc" id="L80">                counts[2]++;</span>
<span class="nc bnc" id="L81" title="All 2 branches missed.">            else if (val &gt;= 60)</span>
<span class="nc" id="L82">                counts[3]++;</span>
            else
<span class="nc" id="L84">                counts[4]++;</span>
<span class="fc" id="L85">        }</span>
<span class="fc" id="L86">        String[] labels = { &quot;90-100% (A):&quot;, &quot;80-89%  (B):&quot;, &quot;70-79%  (C):&quot;, &quot;60-69%  (D):&quot;, &quot;0-59%   (F):&quot; };</span>
<span class="fc" id="L87">        int total = grades.size();</span>

<span class="fc bfc" id="L89" title="All 2 branches covered.">        for (int i = 0; i &lt; 5; i++) {</span>
<span class="fc" id="L90">            double percent = (double) counts[i] / total * 100;</span>
<span class="fc" id="L91">            int barLength = (int) (percent / 2); // Scale down for display</span>
<span class="fc" id="L92">            String bar = repeatString(&quot;█&quot;, barLength) + repeatString(&quot;░&quot;, 50 - barLength);</span>
<span class="fc" id="L93">            sb.append(String.format(&quot;%-15s %s %.1f%% (%d grades)%n&quot;, labels[i], bar, percent, counts[i]));</span>
        }
<span class="fc" id="L95">    }</span>

    // Helper method for Java 8 compatibility
    private String repeatString(String str, int count) {
<span class="fc bfc" id="L99" title="All 2 branches covered.">        if (count &lt;= 0) {</span>
<span class="fc" id="L100">            return &quot;&quot;;</span>
        }
<span class="fc" id="L102">        StringBuilder sb = new StringBuilder(str.length() * count);</span>
<span class="fc bfc" id="L103" title="All 2 branches covered.">        for (int i = 0; i &lt; count; i++) {</span>
<span class="fc" id="L104">            sb.append(str);</span>
        }
<span class="fc" id="L106">        return sb.toString();</span>
    }

    // This method calculates the arithmetic mean of a list of values
    private double calculateMean(List&lt;Double&gt; values) {
<span class="fc" id="L111">        return values.stream().mapToDouble(Double::doubleValue).average().orElse(0.0);</span>
    }

    // This method finds the median value in a list of numbers
    private double calculateMedian(List&lt;Double&gt; values) {
<span class="fc" id="L116">        int size = values.size();</span>
<span class="pc bpc" id="L117" title="1 of 2 branches missed.">        if (size == 0)</span>
<span class="nc" id="L118">            return 0.0;</span>
<span class="pc bpc" id="L119" title="1 of 2 branches missed.">        if (size % 2 == 0) {</span>
<span class="nc" id="L120">            return (values.get(size / 2 - 1) + values.get(size / 2)) / 2.0;</span>
        } else {
<span class="fc" id="L122">            return values.get(size / 2);</span>
        }
    }

    // This method finds the most frequent value (mode) in a list
    private double calculateMode(List&lt;Double&gt; values) {
<span class="fc" id="L128">        Map&lt;Double, Integer&gt; counts = new HashMap&lt;&gt;();</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">        for (Double v : values) {</span>
<span class="fc" id="L130">            counts.put(v, counts.getOrDefault(v, 0) + 1);</span>
<span class="fc" id="L131">        }</span>
<span class="fc" id="L132">        double mode = values.get(0);</span>
<span class="fc" id="L133">        int maxCount = 0;</span>
<span class="fc bfc" id="L134" title="All 2 branches covered.">        for (Map.Entry&lt;Double, Integer&gt; entry : counts.entrySet()) {</span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">            if (entry.getValue() &gt; maxCount) {</span>
<span class="fc" id="L136">                maxCount = entry.getValue();</span>
<span class="fc" id="L137">                mode = entry.getKey();</span>
            }
<span class="fc" id="L139">        }</span>
<span class="fc" id="L140">        return mode;</span>
    }

    // This method calculates the standard deviation of a list of values
    private double calculateStandardDeviation(List&lt;Double&gt; values) {
<span class="fc" id="L145">        double mean = calculateMean(values);</span>
<span class="fc" id="L146">        double sumSquaredDiff = values.stream().mapToDouble(v -&gt; Math.pow(v - mean, 2)).sum();</span>
<span class="fc" id="L147">        return Math.sqrt(sumSquaredDiff / values.size());</span>
    }

    private void appendSubjectPerformance(StringBuilder sb, List&lt;Grade&gt; grades) {
<span class="fc" id="L151">        Map&lt;String, List&lt;Double&gt;&gt; subjectGrades = new HashMap&lt;&gt;();</span>
<span class="fc" id="L152">        Map&lt;String, String&gt; subjectTypes = new HashMap&lt;&gt;();</span>

<span class="fc bfc" id="L154" title="All 2 branches covered.">        for (Grade g : grades) {</span>
<span class="fc" id="L155">            String name = g.getSubject().getSubjectName();</span>
<span class="fc" id="L156">            subjectGrades.computeIfAbsent(name, k -&gt; new ArrayList&lt;&gt;()).add(g.getGrade());</span>
<span class="fc" id="L157">            subjectTypes.put(name, g.getSubject().getSubjectType());</span>
<span class="fc" id="L158">        }</span>

        // Separate Core and Elective
<span class="fc" id="L161">        sb.append(&quot;Core Subjects:\n&quot;);</span>
<span class="fc" id="L162">        subjectGrades.forEach((name, list) -&gt; {</span>
<span class="pc bpc" id="L163" title="1 of 2 branches missed.">            if (subjectTypes.get(name).equalsIgnoreCase(&quot;Core&quot;)) {</span>
<span class="fc" id="L164">                double avg = list.stream().mapToDouble(Double::doubleValue).average().orElse(0.0);</span>
<span class="fc" id="L165">                sb.append(String.format(&quot;  %-15s: %.1f%%%n&quot;, name, avg));</span>
            }
<span class="fc" id="L167">        });</span>

<span class="fc" id="L169">        sb.append(&quot;\nElective Subjects:\n&quot;);</span>
<span class="fc" id="L170">        subjectGrades.forEach((name, list) -&gt; {</span>
<span class="pc bpc" id="L171" title="1 of 2 branches missed.">            if (subjectTypes.get(name).equalsIgnoreCase(&quot;Elective&quot;)) {</span>
<span class="nc" id="L172">                double avg = list.stream().mapToDouble(Double::doubleValue).average().orElse(0.0);</span>
<span class="nc" id="L173">                sb.append(String.format(&quot;  %-15s: %.1f%%%n&quot;, name, avg));</span>
            }
<span class="fc" id="L175">        });</span>
<span class="fc" id="L176">    }</span>

    private void appendStudentTypeComparison(StringBuilder sb, List&lt;Grade&gt; grades, List&lt;Student&gt; students) {
<span class="fc" id="L179">        Map&lt;String, String&gt; studentTypes = students.stream()</span>
<span class="fc" id="L180">                .collect(Collectors.toMap(Student::getStudentId, Student::getStudentType));</span>

<span class="fc" id="L182">        List&lt;Double&gt; regularGrades = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L183">        List&lt;Double&gt; honorsGrades = new ArrayList&lt;&gt;();</span>

<span class="fc bfc" id="L185" title="All 2 branches covered.">        for (Grade g : grades) {</span>
<span class="fc" id="L186">            String type = studentTypes.get(g.getStudentID());</span>
<span class="pc bpc" id="L187" title="1 of 2 branches missed.">            if (type != null) {</span>
<span class="pc bpc" id="L188" title="1 of 2 branches missed.">                if (type.equalsIgnoreCase(&quot;Regular&quot;)) {</span>
<span class="fc" id="L189">                    regularGrades.add(g.getGrade());</span>
<span class="nc bnc" id="L190" title="All 2 branches missed.">                } else if (type.equalsIgnoreCase(&quot;Honors&quot;)) {</span>
<span class="nc" id="L191">                    honorsGrades.add(g.getGrade());</span>
                }
            }
<span class="fc" id="L194">        }</span>

<span class="fc" id="L196">        double regularAvg = regularGrades.stream().mapToDouble(Double::doubleValue).average().orElse(0.0);</span>
<span class="fc" id="L197">        double honorsAvg = honorsGrades.stream().mapToDouble(Double::doubleValue).average().orElse(0.0);</span>

<span class="fc" id="L199">        long regularCount = students.stream().filter(s -&gt; s.getStudentType().equalsIgnoreCase(&quot;Regular&quot;)).count();</span>
<span class="fc" id="L200">        long honorsCount = students.stream().filter(s -&gt; s.getStudentType().equalsIgnoreCase(&quot;Honors&quot;)).count();</span>

<span class="fc" id="L202">        sb.append(String.format(&quot;Regular Students:    %.1f%% average (%d students)%n&quot;, regularAvg, regularCount));</span>
<span class="fc" id="L203">        sb.append(String.format(&quot;Honors Students:     %.1f%% average (%d students)%n&quot;, honorsAvg, honorsCount));</span>
<span class="fc" id="L204">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>